# Проект api_yamdb



В проекте реализовано API приложение для проекта YaMDb,
который собирает отзывы на произведения.

При этом проект не предполагает хранение произведений.

Все произведения делятся на категории: Музыка, фильмы, книги.

Также категориям присваиваются жанры, которых может быть несколько для одного произведения
(драма, фэнтези, комедия, рок и т.д.).

### Технологический стэк
Проект выполнен с использованием:
- **Django** — фреймворк для разработки веб-приложений.
- **Django REST Framework** — инструмент для создания API.
- **SQLite3** — легковесная реляционная база данных.
- **Simple JWT** — библиотека для управления токенами аутентификации.

#### В проекте реализованы роли:
- аноним,
- аутентифицированный пользователь,
- модератор,
- администратор,
- суперюзер Django



### В проекте настроены:
 - модели: 
    * Кастомная модель пользователя (User) в отдельном приложении,
    * Категории произведений (Category),
    * Жанры произведений (Genre),
    * Произведения (Title),
    * Отзывы на произведения (Review),
    * Комментарии к отзывам (Comment)
 - страницы для:
    * регистрации пользователей - для всех,
    * просмотра списка категорий, жанров, произведений, всех отзывов, всех комментариев к отзыву - для всех
    * отдельного произведения, отдельного отзыва, отдельного комментария - для всех,
    * возможность добавлять отзыв, комментарий - для аутентифицированных пользователей,
 - отдельные права для администраторов, модераторов - о них подробнее можно посмотреть в документации.
    

### Как запустить проект:

Клонировать репозиторий и перейти в него в командной строке:

```
git clone git@github.com:RomanKim94/api_yamdb.git
cd api_yamdb
```

Установить и запустить виртуальное окружение:

```
python3.9 -m venv venv
source venv/bin/activate
```

Установить зависимости указанные в requirements.txt:
```
pip install -r requirements.txt
```

Перейти в проект:

```
cd api_yamdb/api_yamdb
```

Применить миграции:

```
python manage.py migrate
```

Запустить проект:

```
python manage.py runserver
```

## Фикстуры
Фикстуры храняться в csv-файлах, расположенных в "api_yamdb/static/data".  
Фикстуры для модели Title в файле "titles.csv".  
Фикстуры для модели Category в файле "category.csv".  
Фикстуры для модели Genre в файле "genre.csv".  
Фикстуры для модели Review в файле "review.csv".  
Фикстуры для модели Comment в файле "comments.csv".  
Фикстуры для модели User в файле "users.csv".  
Фикстуры для промежуточной модели Title_Genre в файле "genre_title.csv".  

## Management команды
Для создания записей в базе данных на основе фикстур, необходимо из директории "api_yamdb", в которой расположен файл "manage.py", запустить менеджмент команду:  
```
python manage.py load_csv
```
Для создания записей по нескольким файлам, указать необходимые файлы в конце команды, в виде `python manage.py load_csv <file_name> <file_name>`. Пример:
```
python manage.py load_csv category.csv comments.csv
```

## Примеры запросов:

1. Регистрация нового пользователя:

POST запрос на адрес http://127.0.0.1:8000/api/v1/auth/signup/
с параметрами:
```
{

    "email": "user@example.com",
    "username": "^w\\Z"

}
```

2. Просмотр категорий, жанров, произведений:

GET запросы: 
```
http://127.0.0.1:8000/api/v1/titles/
http://127.0.0.1:8000/api/v1/categories/
http://127.0.0.1:8000/api/v1/genres/
```

Варианты ответов:

Список произведений
```
{
  "count": 0,
  "next": "string",
  "previous": "string",
  "results": [
    {
      "id": 0,
      "name": "string",
      "year": 0,
      "rating": 0,
      "description": "string",
      "genre": [
        {
          "name": "string",
          "slug": "^-$"
        }
      ],
      "category": {
        "name": "string",
        "slug": "^-$"
      }
    }
  ]
}
```

Список категорий
```
{

    "count": 0,
    "next": "string",
    "previous": "string",
    "results": 

[

        {
            "name": "string",
            "slug": "^-$"
        }
    ]

}
```

3. Добавление нового отзыва:

POST запрос аутентифицированного пользователя: http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/
```
{

    "text": "string",
    "score": 1

}
```



4. Добавление комментария:

POST запрос аутентифицированного пользователя: 
http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/{review_id}/comments/

```
{

    "text": "string"

}
```


Более подробно проект описан в документации [REDOC](http://127.0.0.1:8000/redoc/)


Над проектом работали:

[Станислав Сухов](https://github.com/exctac): 

написал всю часть, касающуюся управления пользователями:
- систему регистрации и аутентификации,
- права доступа,
- работу с токеном,
- систему подтверждения через e-mail

[Роман Ким](https://github.com/RomanKim94): 

 - написал вьюсеты, сериализаторы, эндпоинты для
    - отзывов,
    - произведений
 - реализовал management команду для импорта данных из csv.

[Ирина Никитина](https://github.com/irinik): 
 - написала вьюсеты, сериализаторы, эндпоинты для
    - категорий,
    - жанров,
    - произведений.
